<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp" />
  
  <meta name="author" content="Inno">
  
  <meta name="description" content="inno的个人博客网站，关注Javascript，Golang，Nodejs，Deno，微信小程序等web开发常用技术。">
  
  <meta name="keywords" content="leetcode,golang,javascript,typescript,deno,nodejs,算法,前端,后端">
  
  
  <link rel="prev" href="https://blog.innoweb.cn/2020/%E4%BF%84%E7%BD%97%E6%96%AF%E5%86%9C%E6%B0%91%E4%B9%98%E6%B3%95/" />
  
  <link rel="next" href="https://blog.innoweb.cn/2020/%E5%A4%A7%E6%95%B0%E7%9B%B8%E5%8A%A0%E5%92%8C%E5%A4%A7%E6%95%B0%E7%9B%B8%E4%B9%98/" />
  <link rel="canonical" href="https://blog.innoweb.cn/2020/%E4%BD%8D%E8%BF%90%E7%AE%97/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link href="/favicon.ico" rel="icon" type="image/x-icon">
  <link href="https://blog.innoweb.cn/favicon.ico" rel="icon" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
    
    
    位运算技巧总结 | Inno`s Blog
    
  </title>
  <meta name="title"
    content="位运算技巧总结 | Inno`s Blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/blog.innoweb.cn\/"
    },
    "articleSection" : "posts",
    "name" : "位运算技巧总结",
    "headline" : "位运算技巧总结",
    "description" : "位运算技巧总结",
    "inLanguage" : "zh-CN",
    "author" : "Inno",
    "creator" : "Inno",
    "publisher": "Inno",
    "accountablePerson" : "Inno",
    "copyrightHolder" : "Inno",
    "copyrightYear" : "2020",
    "datePublished": "2020-06-04 17:13:24 \x2b0800 CST",
    "dateModified" : "2020-06-04 17:13:24 \x2b0800 CST",
    "url" : "https:\/\/blog.innoweb.cn\/2020\/%E4%BD%8D%E8%BF%90%E7%AE%97\/",
    "wordCount" : "4951",
    "keywords" : [ "位运算","算法", "Inno`s Blog"]
}
</script>

</head>



  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    
        <div class="top-scroll-bar"></div>
    
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://blog.innoweb.cn/">Inno`s Blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                <a class="menu-item" href="/github/" title="inno†">Inno †</a>
                
        </div>
        
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
    
    <div class="top-scroll-bar"></div>
    
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://blog.innoweb.cn/">Inno`s Blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                <a class="menu-item" href="/github/" title="inno†">Inno †</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">位运算技巧总结</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://blog.innoweb.cn/" rel="author">Inno</a> with ♥ 
                <span class="post-time">
                on <time datetime=2020-06-04 itemprop="datePublished">June 4, 2020</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://blog.innoweb.cn/categories/Algorithm/"> Algorithm </a>
                        
                </span>
                <span class="post-word-count" style="float: right;">Total <code>4951</code> words</span>
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          <h2 id="位运算基础">位运算基础</h2>
<hr>
<p><strong>位操作</strong> 是<a href="https://zh.wikipedia.org/wiki/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1">程序设计</a>中对<a href="https://zh.wikipedia.org/w/index.php?title=%E4%BD%8D%E6%A8%A1%E5%BC%8F&amp;action=edit&amp;redlink=1">位模式</a>或<a href="https://zh.wikipedia.org/wiki/%E4%BA%8C%E9%80%B2%E4%BD%8D%E6%95%B8">二进制数</a>的一元和二元操作。在许多古老的<a href="https://zh.wikipedia.org/wiki/%E5%BE%AE%E5%A4%84%E7%90%86%E5%99%A8">微处理器</a>上，位运算比加减运算略快，通常位运算比乘除法运算要快很多。在现代架构中，情况并非如此：位运算的运算速度通常与加法运算相同（仍然快于乘法运算）。<img src="http://image.innoweb.cn/2020-06-25-132036.png" alt="image-20200622132032633"></p>
<p>基本的位操作符有与、或、异或、取反、左移、右移这6种，在这6种操作符，只有~取反是单目操作符，其它5种都是双目操作符：</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&amp;</code></td>
<td>只有两个对应位都为 1 时才为 1</td>
</tr>
<tr>
<td><code>|</code></td>
<td>只要两个对应位中有一个 1 时就为 1</td>
</tr>
<tr>
<td><code>^</code></td>
<td>只有两个对应位不同时才为 1</td>
</tr>
<tr>
<td><code>~</code></td>
<td>0变1，1变0</td>
</tr>
<tr>
<td><code>&lt;&lt;</code></td>
<td>各二进位全部左移若干位，高位丢弃，低位补0</td>
</tr>
<tr>
<td><code>&gt;&gt;</code></td>
<td>各二进位全部右移若干位，对无符号数，高位补0，有符号数，各编译器处理方法不一样。</td>
</tr>
</tbody>
</table>
<p>位操作符的运算优先级比较低，因为尽量使用括号来确保运算顺序，否则很可能会得到莫明其妙的结果。比如要得到像<code>1，3，5，9</code>这些<code>2^i+1</code>的数字。写成<code>int a = 1 &lt;&lt; i + 1</code>是不对的，程序会先执行<code>i + 1</code>，再执行左移操作。应该写成<code>int a = (1 &lt;&lt; i) + 1</code>。</p>
<blockquote>
<p><strong>注意：</strong> 位操作只能用于整形数据，对float和double类型进行位操作会被编译器报错。</p>
</blockquote>
<h3 id="取反-not">取反 <code>NOT</code></h3>
<p><strong>取反</strong>是一元运算符，对一个二进制数的每一位执行逻辑<a href="https://zh.wikipedia.org/wiki/%E5%8F%8D">反</a>操作。使数字1成为0，0成为1。例如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">NOT</span> <span style="color:#ae81ff">0111</span><span style="color:#960050;background-color:#1e0010">（</span><span style="color:#a6e22e">十进制7</span><span style="color:#960050;background-color:#1e0010">）</span>
  = <span style="color:#ae81ff">1000</span><span style="color:#960050;background-color:#1e0010">（</span><span style="color:#a6e22e">十进制8</span><span style="color:#960050;background-color:#1e0010">）</span>
</code></pre></div><p>许多程序设计语言，取反操作符用波浪线&quot;<code>~</code>&quot;表示。值得注意的是此操作符与&quot;逻辑非（<code>!</code>）&ldquo;操作符不同。&ldquo;逻辑非&quot;并不是一个位操作。</p>
<h3 id="按位或-or">按位或 <code>OR</code></h3>
<p><strong>按位或</strong>处理两个长度相同的二进制数，两个相应的二进位中只要有一个为1，该位的结果值为1。例如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">   <span style="color:#ae81ff">0101</span><span style="color:#960050;background-color:#1e0010">（</span><span style="color:#a6e22e">十进制5</span><span style="color:#960050;background-color:#1e0010">）</span>
<span style="color:#a6e22e">OR</span> <span style="color:#ae81ff">0011</span><span style="color:#960050;background-color:#1e0010">（</span><span style="color:#a6e22e">十进制3</span><span style="color:#960050;background-color:#1e0010">）</span>
 = <span style="color:#ae81ff">0111</span><span style="color:#960050;background-color:#1e0010">（</span><span style="color:#a6e22e">十进制7</span><span style="color:#960050;background-color:#1e0010">）</span>
</code></pre></div><p>在C类程序设计语言中，按位或操作符是&quot;|&rdquo;。这一操作符需要与逻辑或运算符（||）区别开来。</p>
<h3 id="按位异或-xor">按位异或 <code>XOR</code></h3>
<p><strong>按位异或</strong>运算，对等长二进制模式或二进制数的每一位执行逻辑异或操作。操作的结果是如果某位不同则该位为1，否则该位为0。例如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">    <span style="color:#ae81ff">0101</span>
<span style="color:#a6e22e">XOR</span> <span style="color:#ae81ff">0011</span>
  = <span style="color:#ae81ff">0110</span>
</code></pre></div><p>在类C语言中，按位异或运算符是&quot;<code>^</code>&rdquo;，将下面<code>A</code>和<code>B</code>的二进制表示的每一位进行异或操作：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ae81ff">1</span> ^ <span style="color:#ae81ff">1</span> = <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> ^ <span style="color:#ae81ff">0</span> = <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> ^ <span style="color:#ae81ff">1</span> = <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> ^ <span style="color:#ae81ff">0</span> = <span style="color:#ae81ff">0</span>
</code></pre></div><p>从上面这些结果中可以总结出，异或操作也就是<code>不进位加法</code>，比如1 + 1 = 10， 我们只取个位，不要进位的那个1，其他同理。</p>
<h3 id="按位与-and">按位与 <code>AND</code></h3>
<p>按位与处理两个长度相同的二进制数，两个相应的二进位都为1，该位的结果值才为1，否则为0。例如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">    <span style="color:#ae81ff">0101</span>
<span style="color:#a6e22e">AND</span> <span style="color:#ae81ff">0011</span>
  = <span style="color:#ae81ff">0001</span>
</code></pre></div><p>在类C语言中，按位与用&rsquo;&amp;&lsquo;表示</p>
<h3 id="移位--">移位 <code>&lt;&lt; &gt;&gt;</code></h3>
<p><strong><code>&lt;&lt;</code> 左移运算</strong> ，向左进行移位操作，高位丢弃，低位补 0，如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;
a <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>;
<span style="color:#960050;background-color:#1e0010">移</span><span style="color:#960050;background-color:#1e0010">位</span><span style="color:#960050;background-color:#1e0010">前</span><span style="color:#960050;background-color:#1e0010">：</span><span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">1000</span>
<span style="color:#960050;background-color:#1e0010">移</span><span style="color:#960050;background-color:#1e0010">位</span><span style="color:#960050;background-color:#1e0010">后</span><span style="color:#960050;background-color:#1e0010">：</span><span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0100</span> <span style="color:#ae81ff">0000</span>
</code></pre></div><p><strong><code>&gt;&gt;</code> 右移运算</strong>，向右进行移位操作，对无符号数，高位补 0，对于有符号数，高位补符号位，如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;
a <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">3</span>;
<span style="color:#960050;background-color:#1e0010">移</span><span style="color:#960050;background-color:#1e0010">位</span><span style="color:#960050;background-color:#1e0010">前</span><span style="color:#960050;background-color:#1e0010">：</span><span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">1000</span>
<span style="color:#960050;background-color:#1e0010">移</span><span style="color:#960050;background-color:#1e0010">位</span><span style="color:#960050;background-color:#1e0010">后</span><span style="color:#960050;background-color:#1e0010">：</span><span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0001</span>

<span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">8</span>;
a <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">3</span>;
<span style="color:#960050;background-color:#1e0010">移</span><span style="color:#960050;background-color:#1e0010">位</span><span style="color:#960050;background-color:#1e0010">前</span><span style="color:#960050;background-color:#1e0010">：</span><span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1000</span>
<span style="color:#960050;background-color:#1e0010">移</span><span style="color:#960050;background-color:#1e0010">位</span><span style="color:#960050;background-color:#1e0010">前</span><span style="color:#960050;background-color:#1e0010">：</span><span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span> <span style="color:#ae81ff">1111</span>
</code></pre></div><h2 id="与运算技巧">与<code>&amp;</code>运算技巧</h2>
<hr>
<p><code>&amp;</code>运算可以用来消去二进制中的某一位，<code>x &amp; (x - 1)</code> 用于消去<code>x</code>最后一位的1, 比如<code>x = 12</code>, 那么在二进制下就是<code>1100</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">x</span>           <span style="color:#f92672">=</span> <span style="color:#ae81ff">1100</span>
<span style="color:#a6e22e">x</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>       <span style="color:#f92672">=</span> <span style="color:#ae81ff">1011</span>
<span style="color:#a6e22e">x</span> <span style="color:#f92672">&amp;</span> (<span style="color:#a6e22e">x</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</code></pre></div><p>当然<code>&amp;</code>运算也可用来判断奇偶数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">==</span> (<span style="color:#a6e22e">a</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>)
</code></pre></div><h3 id="技巧一o1-时间检测整数-n-是否是-2-的幂次"><strong>技巧一：O(<em>1</em>) 时间检测整数 <em>n</em> 是否是 <em>2</em> 的幂次</strong></h3>
<p>N如果是2的幂次，则N满足两个条件：</p>
<ul>
<li>N &gt; 0</li>
<li>N的二进制表示中<code>只有一个1</code>, 有多个那叫<code>2的倍数</code>。</li>
</ul>
<p>因为<code>N</code>的二进制表示中只有一个<code>1</code>，所以使用<code>N &amp; (N - 1)</code>将N唯一的一个<code>1</code>消去，应该返回<code>0</code>，下面是<code>golang</code>的代码实现，注意运算符优先级。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">isPowerOfTwo</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">bool</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span> &gt; <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">&amp;</span> (<span style="color:#a6e22e">n</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> 
}
</code></pre></div><blockquote>
<p><a href="https://leetcode-cn.com/problems/power-of-two/">leetcode - 231. 2的幂</a></p>
</blockquote>
<h3 id="技巧二-32-位的整数的二进制中有多少个-1"><strong>技巧二： <em>32</em> 位的整数的二进制中有多少个 <em>1</em></strong></h3>
<p>由<code>x &amp; (x - 1)</code>消去x最后一位的1可知。不断使用 <code>x &amp; (x - 1) </code>消去<code>x</code>最后一位的1，计算总共消去了多少次即可。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">countOne</span>(<span style="color:#a6e22e">num</span> <span style="color:#66d9ef">uint32</span>) <span style="color:#66d9ef">int</span> {
    <span style="color:#a6e22e">count</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">num</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> {
        <span style="color:#a6e22e">num</span> = <span style="color:#a6e22e">num</span> <span style="color:#f92672">&amp;</span> (<span style="color:#a6e22e">num</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
        <span style="color:#a6e22e">count</span><span style="color:#f92672">++</span>
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">count</span>
}
</code></pre></div><blockquote>
<p><a href="https://leetcode-cn.com/problems/number-of-1-bits/">leetcode - 191. 位1的个数</a></p>
</blockquote>
<h3 id="技巧三如果要将整数-a转换为-b需要改变多少个bit位">技巧三：如果要将整数 A转换为 B，需要改变多少个bit位？</h3>
<p>整数A转换为B，如果A和B在第<code>i（0 &lt;=i &lt; 32）</code>个位上相等，则不需要改变这个BIT位，如果在第i位上不相等，则需要改变这个BIT位，所以问题转化为了A和B有多少个BIT位不相同，那么直接使用异或运算，可以得出所有不同的位，之后计算1的个数即可。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">bitSwapRequired</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span> <span style="color:#66d9ef">uint32</span>) <span style="color:#66d9ef">int</span> {
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">countOne</span>(<span style="color:#a6e22e">a</span>^<span style="color:#a6e22e">b</span>)
}
</code></pre></div><h2 id="异或运算技巧">异或<code>^</code>运算技巧</h2>
<hr>
<p>对于异或运算，首先我们要知道异或运算有以下三个性质：</p>
<p><code>$$ a⊕0=a $$</code></p>
<p><code>$$ a⊕a=0 $$</code></p>
<p><code>$$ a⊕b⊕a=b⊕(a⊕a)=b⊕0=b $$</code></p>
<p>最后还有一个特性就是我们上面提到过的，异或等于<code>无进位加法</code>。</p>
<h3 id="技巧一无额外变量的值交换"><strong>技巧一：无额外变量的值交换</strong></h3>
<p>不需要额外变量的值交换，下面是这个技巧的代码实现：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">a</span><span style="color:#f92672">^</span><span style="color:#a6e22e">b</span>
<span style="color:#a6e22e">b</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">a</span><span style="color:#f92672">^</span><span style="color:#a6e22e">b</span>
<span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">a</span><span style="color:#f92672">^</span><span style="color:#a6e22e">b</span>
</code></pre></div><p>这个技巧运用了性质三<code>a ⊕ b ⊕ a=b ⊕ (a ⊕ a)=b</code>，也就是交换律和性质一、性质二结合，下面是详细的推导过程：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">            | <span style="color:#a6e22e">a</span>         | <span style="color:#a6e22e">b</span>
<span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">+</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">-</span><span style="color:#f92672">+</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span><span style="color:#f92672">--</span>
<span style="color:#a6e22e">step</span> <span style="color:#a6e22e">one</span>    | <span style="color:#a6e22e">a</span>^<span style="color:#a6e22e">b</span>       | <span style="color:#a6e22e">b</span>
<span style="color:#a6e22e">step</span> <span style="color:#a6e22e">two</span>    | <span style="color:#a6e22e">a</span>^<span style="color:#a6e22e">b</span>       | <span style="color:#a6e22e">b</span>^(<span style="color:#a6e22e">a</span>^<span style="color:#a6e22e">b</span>)=<span style="color:#a6e22e">a</span>
<span style="color:#a6e22e">step</span> <span style="color:#a6e22e">three</span>  | <span style="color:#a6e22e">a</span>^(<span style="color:#a6e22e">b</span>^<span style="color:#a6e22e">a</span>)=<span style="color:#a6e22e">b</span> | <span style="color:#a6e22e">a</span>
</code></pre></div><h3 id="技巧二无加号加法"><strong>技巧二：无加号加法</strong></h3>
<p>无加号加法，给出两个整数a和b, 求他们的和, 但不能使用 + 等数学运算符：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">输入</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>
<span style="color:#a6e22e">输出</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>
</code></pre></div><p>这个算法主要利用异或运算来完成，异或运算有一个别名叫做：<code>不进位加法</code>，<code>a ^ b</code>就是<code>a</code>和<code>b</code>相加之后，该进位的地方不进位的结果，而如果我们想要用它实现真正的加法，给<code>a</code>和<code>b</code>里都是1的地方进位操作，<code>a&amp;b</code>能让我们找出都为一的地方，那么这些位置<code>左边</code>都应该有一个进位1，<code>a &amp; b &lt;&lt; 1</code> 就是<code>进位的数值</code>。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">a</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">b</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">a</span> <span style="color:#f92672">^</span> <span style="color:#a6e22e">b</span>) <span style="color:#f92672">+</span> (<span style="color:#a6e22e">a</span> <span style="color:#f92672">&amp;</span> <span style="color:#a6e22e">b</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
</code></pre></div><p>可我们不能使用中间的这个加号，所以我们令<code>a' = a ^ b, b' = (a &amp; b) &lt;&lt; 1</code> =&gt; <code>a = a', b = b'</code>，然后反复迭代，这个过程是在二进制下模拟加法的运算过程，进位不可能一直持续，<code>b</code>最终会变为<code>0</code>，也就是没有需要进位的了，因此重复做上述操作就可以最终求得<code>a + b</code>的值。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">add</span>(<span style="color:#a6e22e">a</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">b</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int</span> {
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">b</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> {
        <span style="color:#a6e22e">sum</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">a</span> ^ <span style="color:#a6e22e">b</span>
        <span style="color:#a6e22e">carry</span> <span style="color:#f92672">:=</span> (<span style="color:#a6e22e">a</span> <span style="color:#f92672">&amp;</span> <span style="color:#a6e22e">b</span>) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>

        <span style="color:#a6e22e">a</span> = <span style="color:#a6e22e">sum</span>
        <span style="color:#a6e22e">b</span> = <span style="color:#a6e22e">carry</span>
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span>
}
</code></pre></div><blockquote>
<p><a href="https://leetcode-cn.com/problems/sum-of-two-integers/">leetcode - 371. 两整数之和</a></p>
</blockquote>
<h3 id="技巧三只出现一次的数字"><strong>技巧三：只出现一次的数字</strong></h3>
<p>数组中只有一个数出现一次，剩下都出现两次，找出出现一次的数，其实这是LeetCode上的一道算法题<a href="https://leetcode-cn.com/problems/single-number/">136. 只出现一次的数字</a>。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">输入</span>: [<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]
<span style="color:#a6e22e">输出</span>: <span style="color:#ae81ff">1</span>
</code></pre></div><p>对于这道题我们知道<code>a ^ b ^ b = a</code> 所以只要将所有的数异或起来，就可以得到唯一的那个数，因为相同的数出现的两次，异或两次等价于没有任何操作。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * @param {number[]} nums
</span><span style="color:#75715e"> * @return {number}
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">singleNumber</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">nums</span>) {
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">num</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#a6e22e">nums</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">item</span> =&gt; {
        <span style="color:#a6e22e">num</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">num</span> <span style="color:#f92672">^</span> <span style="color:#a6e22e">item</span>
    })
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">num</span>
};
</code></pre></div><blockquote>
<p><a href="https://leetcode-cn.com/problems/single-number/">leetcode - 136. 只出现一次的数字</a></p>
</blockquote>
<h3 id="技巧三只出现一次的数字-iihttpsleetcode-cncomproblemssingle-number-ii">技巧三：只出现一次的数字 <a href="https://leetcode-cn.com/problems/single-number-ii/">II</a></h3>
<p>数组中，只有一个数出现一次，剩下都出现三次，找出出现一次的数？</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">输入</span><span style="color:#f92672">:</span> [<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>]
<span style="color:#a6e22e">输出</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>
</code></pre></div><p>如下图所示，考虑数字的二进制形式，对于出现三次的数字，各 二进制位 出现的次数都是 <em>3</em> 的倍数，因此，统计所有数字的各二进制位中 <em>1</em> 的出现次数，并对 <em>3</em> 求余，结果则为只出现一次的数字。</p>
<p><img src="http://image.innoweb.cn/2020-06-25-132028.png" alt="image-20200622150916409"></p>
<p>各二进制位的<strong>位运算规则相同</strong>，因此只需考虑一位即可。如下图所示，对于所有数字中的某二进制位 1 的个数，存在 3 种状态，即对 3 余数为 0, 1, 2。</p>
<ul>
<li>若输入二进制位 11 ，则状态按照以下顺序转换。</li>
<li>若输入二进制位 00 ，则状态不变。</li>
</ul>
<p><code>$$ 0→1→2→0→⋯ $$</code></p>
<p><img src="http://image.innoweb.cn/2020-06-25-132023.png" alt="image-20200622151157802"></p>
<p>如下图所示，由于二进制只能表示 0, 10,1 ，因此需要使用两个二进制位来表示 33 个状态。设此两位分别为<code>two , one</code> ，则状态转换变为：</p>
<p><code>$$ 00→01→10→00→⋯ $$</code></p>
<p><img src="http://image.innoweb.cn/2020-06-25-132019.png" alt="image-20200622151355472"></p>
<p>接下来，需要通过 状态转换表 导出 状态转换的计算公式 。首先回忆一下位运算特点，对于任意二进制位 x，有：</p>
<ul>
<li>异或运算：<code>x ^ 0 = x ， x ^ 1 = ~x</code></li>
<li>与运算：<code>x &amp; 0 = 0 ， x &amp; 1 = x</code></li>
</ul>
<p>设当前状态为<code>two one </code>，此时输入二进制位 <code>n</code> 。如下图所示，通过对状态表的情况拆分，可推出<code>one</code>的计算方法为：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">two</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">:</span>
  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">:</span>
    <span style="color:#a6e22e">one</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">one</span>
  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>
    <span style="color:#a6e22e">one</span> <span style="color:#f92672">=</span> <span style="color:#f92672">~</span><span style="color:#a6e22e">one</span>
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">two</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>
    <span style="color:#a6e22e">one</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</code></pre></div><p>引入 <strong>异或运算</strong> ，可将以上拆分简化为：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">two</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">:</span>
    <span style="color:#a6e22e">one</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">one</span> <span style="color:#f92672">^</span> <span style="color:#a6e22e">n</span>
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">two</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>
    <span style="color:#a6e22e">one</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</code></pre></div><p>引入 <strong>与运算</strong> ，可继续简化为：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">one</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">one</span> <span style="color:#f92672">^</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span><span style="color:#a6e22e">two</span>
</code></pre></div><p><img src="http://image.innoweb.cn/2020-06-25-132014.png" alt="image-20200622153133875"></p>
<p>由于是先计算 one ，因此应在新 one 的基础上计算 two 。
如下图所示，修改为新 oneone 后，得到了新的状态图。观察发现，可以使用同样的方法计算 two ，即：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">two</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">two</span> <span style="color:#f92672">^</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span><span style="color:#a6e22e">one</span>
</code></pre></div><p><img src="http://image.innoweb.cn/2020-06-25-132011.png" alt="image-20200622153242099"></p>
<p>以上是对数字的二进制中 “一位” 的分析，而 int 类型的其他 31 位具有相同的运算规则，因此可将以上公式直接套用在 32 位数上。</p>
<p>遍历完所有数字后，各二进制位都处于状态 00 和状态 01 （取决于 “只出现一次的数字” 的各二进制位是 11 还是 00 ），而此两状态是由 one 来记录的（此两状态下 twos 恒为 00 ），因此返回 ones 即可。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span> {
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">singleNumber</span>(<span style="color:#66d9ef">int</span>[] <span style="color:#a6e22e">nums</span>) {
        <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">ones</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">twos</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">num</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">nums</span>){
            <span style="color:#a6e22e">ones</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ones</span> <span style="color:#f92672">^</span> <span style="color:#a6e22e">num</span> <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span><span style="color:#a6e22e">twos</span>;
            <span style="color:#a6e22e">twos</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">twos</span> <span style="color:#f92672">^</span> <span style="color:#a6e22e">num</span> <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span><span style="color:#a6e22e">ones</span>;
        }
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ones</span>;
    }
}
</code></pre></div><blockquote>
<p><a href="https://leetcode-cn.com/problems/single-number-ii/">leetcode - 137. 只出现一次的数字 II</a></p>
<p><strong>解法摘自：</strong> <a href="https://leetcode-cn.com/problems/single-number-ii/solution/single-number-ii-mo-ni-san-jin-zhi-fa-by-jin407891/">https://leetcode-cn.com/problems/single-number-ii/solution/single-number-ii-mo-ni-san-jin-zhi-fa-by-jin407891/</a></p>
</blockquote>
<h2 id="取非运算技巧-">取非运算技巧 <code>~</code></h2>
<hr>
<h3 id="技巧一位操作交换符号">技巧一：位操作交换符号</h3>
<p>交换符号将正数变成负数，负数变成正数。</p>
<p><strong>原理：</strong> 整数取反加1，正好变成其对应的负数(补码表示)；负数取反加一，则变为其原码，即正数</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">reversal</span>(<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">a</span>) {
  <span style="color:#66d9ef">return</span> <span style="color:#f92672">~</span><span style="color:#a6e22e">a</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
}
</code></pre></div><blockquote>
<p><strong>注意：</strong> 如果说负数是范围最小值的时候，使用该方法仍然得到该负数。</p>
</blockquote>
<h2 id="移位运算技巧--">移位运算技巧 <code>&lt;&lt; &gt;&gt;</code></h2>
<hr>
<p>移位运算可以实现乘除法，数 a 向右移一位，相当于将 a 除以 2；数 a 向左移一位，相当于将 a 乘以 2</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> 2<span style="color:#f92672">;</span>
a <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> 1<span style="color:#f92672">;</span> <span style="color:#f92672">-</span><span style="color:#f92672">-</span><span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> 1
a <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> 1<span style="color:#f92672">;</span> <span style="color:#f92672">-</span><span style="color:#f92672">-</span><span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> 4
</code></pre></div><h3 id="技巧一求绝对值">技巧一：求绝对值</h3>
<p>整数的绝对值是其本身，负数的绝对值正好可以对其进行取反加一求得，即我们首先判断其<code>符号位（整数右移 31 位得到 0，负数右移 31 位得到 -1,即 0xffffffff）</code>，然后根据符号进行相应的操作</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">c</span> <span style="color:#66d9ef">int8</span> = <span style="color:#f92672">-</span><span style="color:#ae81ff">128</span>
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">7</span>)

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">abs</span>(<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">a</span>) {
  <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">i</span> = <span style="color:#a6e22e">a</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span>;
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#960050;background-color:#1e0010">?</span> <span style="color:#a6e22e">a</span> : (<span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">a</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
}
</code></pre></div><p>上面的操作可以进行优化，可以将 i == 0 的条件判断语句去掉。我们都知道符号位 i 只有两种情况，即 i = 0 为正，i = -1 为负。对于任何数与 0 异或都会保持不变，与 -1 即 0xffffffff 进行异或就相当于对此数进行取反,因此可以将上面三目元算符转换为((a^i)-i)，即整数时 a 与 0 异或得到本身，再减去 0，负数时与 0xffffffff 异或将 a 进行取反，然后在加上 1，即减去 i(i =-1)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">abs2</span>(<span style="color:#66d9ef">int</span> a) {
  <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> a <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">31</span>;
  <span style="color:#66d9ef">return</span> ((a<span style="color:#f92672">^</span>i) <span style="color:#f92672">-</span> i);
}
</code></pre></div><h3 id="技巧二无符号数高低位交换">技巧二：无符号数高低位交换</h3>
<p>给定一个 16 位的无符号整数，将其高 8 位与低 8 位进行交换，求出交换后的值，如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ae81ff">34520</span><span style="color:#a6e22e">的二进制表示</span><span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#ae81ff">10000110</span> <span style="color:#ae81ff">11011000</span>

<span style="color:#a6e22e">将其高8位与低8位进行交换</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#a6e22e">得到一个新的二进制数</span><span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#ae81ff">11011000</span> <span style="color:#ae81ff">10000110</span>
<span style="color:#a6e22e">其十进制为55430</span>
</code></pre></div><p>只要将无符号数 a&raquo;8 即可得到其高 8 位移到低 8 位，高位补 0；将 a&laquo;8 即可将 低 8 位移到高 8 位，低 8 位补 0，然后将 a&raquo;8 和 a&laquo;8 进行或操作既可求得交换后的结果。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">short</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">34520</span>;
a <span style="color:#f92672">=</span> (a <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">|</span> (a <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>);
</code></pre></div><h3 id="技巧三无符号数逆序">技巧三：无符号数逆序</h3>
<p>将无符号数的二进制表示进行逆序，求取逆序后的结果，如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">数34520的二进制表示：
10000110 11011000

逆序后则为：
00011011 01100001
它的十进制为7009
</code></pre></div><p>在字符串逆序过程中，可以从字符串的首尾开始，依次交换两端的数据。在二进制中使用位的高低位交换会更方便进行处理，这里我们分组进行多步处理。</p>
<ul>
<li>第一步:以每 2 位为一组，组内进行高低位交换</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">交换前： 10 00 01 10 11 01 10 00
交换后： 01 00 10 01 11 10 01 00
</code></pre></div><ul>
<li>第二步：在上面的基础上，以每 4 位为 1 组，组内高低位进行交换</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">交换前： 0100 1001 1110 0100
交换后： 0001 0110 1011 0001
</code></pre></div><ul>
<li>第三步：以每 8 位为一组，组内高低位进行交换</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">交换前： 00010110 10110001
交换后： 01100001 00011011
</code></pre></div><ul>
<li>第四步：以每16位为一组，组内高低位进行交换</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">交换前： 0110000100011011
交换后： 0001101101100001
</code></pre></div><p>对于上面的第一步，依次以 2 位作为一组，再进行组内高低位交换，这样处理起来比较繁琐，下面介绍另外一种方法进行处理。先分别取原数 10000110 11011000 的奇数位和偶数位，将空余位用 0 填充：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">原数：  10000110 11011000
奇数位： 10000010 10001000
偶数位： 00000100 01010000
</code></pre></div><p>再将奇数位右移一位，偶数位左移一位，此时将两个数据相或即可以达到奇偶位上数据交换的效果：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">原数：  10000110 11011000
奇数位右移一位： 0 10000010 1000100
偶数位左移一位：0000100 01010000 0
两数相或得到： 01001001 11100100
</code></pre></div><p>上面的方法用位操作可以表示为：</p>
<ul>
<li>取 <em>a</em> 的奇数位并用 <em>0</em> 进行填充可以表示为：<code>a &amp; 0xAAAA (1010)</code>。</li>
<li>取 <em>a</em> 的偶数为并用 <em>0</em> 进行填充可以表示为：<code>a &amp; 0x5555 (0101)</code> ，因此，上面的第一步可以表示为：
<code>a = ((a &amp; 0xAAAA) &gt;&gt; 1) | ((a &amp; 0x5555) &lt;&lt; 1)</code></li>
<li>同理，可以得到其第二、三和四步为：
<ul>
<li><code>a = ((a &amp; 0xCCCC) &gt;&gt; 2) | ((a &amp; 0x3333) &lt;&lt; 2)</code></li>
<li><code>a = ((a &amp; 0xF0F0) &gt;&gt; 4) | ((a &amp; 0x0F0F) &lt;&lt; 4)</code></li>
<li><code>a = ((a &amp; 0xFF00) &gt;&gt; 8) | ((a &amp; 0x00FF) &lt;&lt; 8)</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">short</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">34520</span>;

a <span style="color:#f92672">=</span> ((a <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xAAAA</span>) <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> ((a <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x5555</span>) <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>);
a <span style="color:#f92672">=</span> ((a <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xCCCC</span>) <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">|</span> ((a <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x3333</span>) <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>);
a <span style="color:#f92672">=</span> ((a <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xF0F0</span>) <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">|</span> ((a <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x0F0F</span>) <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>);
a <span style="color:#f92672">=</span> ((a <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF00</span>) <span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">|</span> ((a <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x00FF</span>) <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>);
</code></pre></div><h3 id="技巧四返回所有子集">技巧四：返回所有子集</h3>
<p>给定一组<strong>不含重复元素</strong>的整数数组 <em>nums</em>，返回该数组所有可能的子集（幂集）。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">输入</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">nums</span> <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>]
<span style="color:#a6e22e">输出</span><span style="color:#f92672">:</span>
[
  [<span style="color:#ae81ff">3</span>],
  [<span style="color:#ae81ff">1</span>],
  [<span style="color:#ae81ff">2</span>],
  [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>],
  [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>],
  [<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>],
  [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>],
  []
]
</code></pre></div><p>思路就是使用一个<code>正整数</code>二进制表示的<code>第i位</code>是1还是0来代表集合的<code>第i个数取或者不取</code>。</p>
<p>所以从<code>0到2^n-1</code>总共<code>2^n</code>个整数，正好对应集合的<code>2^n</code>个子集，我们对这<code>2^n</code>个整数进行遍历，并且填入对应的元素。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">subsets</span>(<span style="color:#a6e22e">nums</span> []<span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">int</span> {
	  <span style="color:#a6e22e">res</span> <span style="color:#f92672">:=</span> make([][]<span style="color:#66d9ef">int</span>, <span style="color:#ae81ff">0</span>)
    <span style="color:#a6e22e">n</span> <span style="color:#f92672">:=</span> len(<span style="color:#a6e22e">nums</span>)
    
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#a6e22e">n</span>); <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {		<span style="color:#75715e">// 遍历所有位的可能性。
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">subset</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">int</span>, <span style="color:#ae81ff">0</span>)
        <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">j</span> &lt; <span style="color:#a6e22e">n</span>; <span style="color:#a6e22e">j</span><span style="color:#f92672">++</span> {			
            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#a6e22e">j</span>)) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> {	<span style="color:#75715e">// 添加当前可能性下所有位对应数组的数。
</span><span style="color:#75715e"></span>                <span style="color:#a6e22e">subset</span> = append(<span style="color:#a6e22e">subset</span>, <span style="color:#a6e22e">nums</span>[<span style="color:#a6e22e">j</span>])
            }
        }
        <span style="color:#a6e22e">res</span> = append(<span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">subset</span>)
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>
}
</code></pre></div>
    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Inno </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://blog.innoweb.cn/2020/%E4%BD%8D%E8%BF%90%E7%AE%97/>https://blog.innoweb.cn/2020/%E4%BD%8D%E8%BF%90%E7%AE%97/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://blog.innoweb.cn/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/">
                    #位运算</a></span>
            
            <span class="tag"><a href="https://blog.innoweb.cn/tags/%E7%AE%97%E6%B3%95/">
                    #算法</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://blog.innoweb.cn/">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://blog.innoweb.cn/2020/%E4%BF%84%E7%BD%97%E6%96%AF%E5%86%9C%E6%B0%91%E4%B9%98%E6%B3%95/" class="prev" rel="prev" title="俄罗斯农民乘法"><i class="iconfont icon-left"></i>&nbsp;俄罗斯农民乘法</a>
         
        
        <a href="https://blog.innoweb.cn/2020/%E5%A4%A7%E6%95%B0%E7%9B%B8%E5%8A%A0%E5%92%8C%E5%A4%A7%E6%95%B0%E7%9B%B8%E4%B9%98/" class="next" rel="next" title="大数相加和大数相乘">大数相加和大数相乘&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
          
<div id="gitalk-container/" style="border: 0;"></div>
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/gitalk/1.6.2/gitalk.css" style="border: 0;" />
<script src="https://cdn.bootcdn.net/ajax/libs/gitalk/1.6.2/gitalk.js" style="border: 0;"></script>
<script>
  const gitalk = new Gitalk({
    clientID: "29ea93a56bc68af65ba8",
    clientSecret: "0af554128f5f5ec8a81b515d4df19b6238170fd4",
    repo: "blog.innoweb.cn",
    owner: "patrick-prod",
    admin: ["patrick-prod"],
    id: location.pathname, 
    distractionFreeMode: false, 
  });
  (function () {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById("gitalk-container").innerHTML =
        "Gitalk comments not available by default when the website is previewed locally.";
      return;
    }
    gitalk.render("gitalk-container");
  })();
</script>

    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2020 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://blog.innoweb.cn/">Inno</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>














    
     <link href="//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  





     </div>
  </body>
</html>
